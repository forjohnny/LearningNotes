# 动态规划（钢条切割问题）

动态规划（Dynamic programming)与分治法相似，都是通过组合子问题的解来求解原问题，与之相反的是动态规划应用于子问题重叠的情况，即不同子问题具有公共的子子问题。在这种情况下，分治法会做许多不必要的工作，它会反复求解那些公共子问题。动态规划方法通常用来求解最优化问题（optimization problem）。

通常按照以下四个步骤设计一个动态规划算法

- 刻画一个最优解的结构特征。
- 递归定义最优解的值。
- 计算最优解的值，通常采用自底向上的方法。
- 利用计算出来的信息构造一个最优解。

## 钢条切割问题

钢条切割问题是这样的：给定一段长度为$n$英寸的钢条和一个价格表$p_i(i=1,2,3,...)$ ，单位为美元。求切割钢条的方案，使得售价受益$r_n$最大。注意，如果长度为$n$英寸的钢条的价格$p_n$足够大，最优解可能就是完全不需要切割。

| 长度$i$   | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 价格$p_i$ | 1    | 5    | 8    | 9    | 10   | 17   | 17   | 20   | 24   | 30   |

如果一个最优解将钢条切割为$k$段($1\le k \le n$)，那么最优解切割方案
$$
n=i_1+i_2+...+i_k
$$
将钢条长度切割为长度分别是$i_1,i_2,...,i_k$的小段，得到最大收益为
$$
r_n=p_{i_1}+p_{i_1}+...+p_{i_k}
$$
对于上面的价格表，不同长度的钢条的最优收益值$r_i$及切割方案如下：

$r_1=1$,切割方案，1=1（无切割）

$r_2=$5,切割方案，2=2（无切割）

$r_3=8$,切割方案，3=3（无切割）

$r_4=10$,切割方案，4=2+2

$r_5=13$,切割方案，5=2+3

$r_6=17$,切割方案，6=6（无切割）

$r_7=18$,切割方案，7=1+6或7=2+2+3

$r_8=22$,切割方案，8=2+6

$r_9=25$,切割方案，9=3+6

$r_{10}=30$,切割方案，10=10（无切割）

更一般地，对于$r_n(n\ge 1)$,我们可以用更短的钢条切割最优方案来描述它：
$$
r_n=max(p_n,r_1+r_{n-1},r_2+r_{n-2},...,r_{n-1}+r_1)
$$
怎么理解这个解的结构呢？可以这样理解，切割钢条的时候每切割一次，总是把一个钢条切割成两条（不切割时，其中一条长度为0而已）为了求解规模为n的问题，先求解形式完全一样，但规模更小的子问题：即当完成首次切割后，我们将两端钢条看成两个独立的钢条切割问题实例。通过组合两个相关子问题的最优解，并在所有可能的两端切割方案中选取组合受益最大者，构成原问题的最优解。我们称钢条切割问题满足**最优子结构**（optimal substructure）性质：问题的最优解由相关问题的最优解组合而成，而这些子问题可以独立求解。

因此，上面式子，第一个参数$p_n$对应不切割，直接出售长度为$n$的方案。其他$n-1$个参数对应另外$n-1$种方案：对每个$i=1,2,...,n-1$，首先将钢条切割为长度为$i$和$n-i$的两段，接着求这两段最优切割受益$r_i,r_{n-i}$(每种方案的最优受益为两段的最优受益之和)。由于无法预知哪种方案会获得最优受益，我们必须考察所有可能的$i$。

动态规划有两种等价的实现方法，以钢条切割为例展示这两种方法。

第一种称为带备忘的自顶向下发（top-down-with memoization）。此方法仍按自然的递归形式编写过程，但过程会保存每个子问题的解（通常保存在一个数组或散列表中）。若不带备忘，则和分治法是一样的。

第二种称为自底向上法（bottom-up-method）。这种方法一般需要恰当定义子问题“规模”的概念，使得任何子问题的求解都只依赖于“更小的”子问题的求解。因而我们可以将子问题按规模排序，按由小到大的顺序进行求解。当求解某个子问题时，它所依赖的那些更小的子问题都已经求解完毕，结果已经保存。每个子问题只需求解一次，当我们求解它时，它的所有前提子问题都已求解完成。

这里给出两种方法的代码。





参考文献

[1]算法导论（原书第3版）（美）科尔曼（Cormen, H.H.）等著;殷建平 等译.北京：机械工业出版社，2013,1（2016.6重印）